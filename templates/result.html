<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Triage Result – Smart Triage</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<body style="background: var(--surface-50); min-height: 100vh;">
  <!-- ───────────────────── Header ───────────────────── -->
  <header class="site-header">
    <div class="header-inner">
      <a href="/" class="logo">
        <span class="med-cross" aria-hidden="true"></span>
        <h1>Smart Triage</h1>
      </a>
      <p class="tagline">Assessment Results</p>
      <div class="auth-links" style="display: flex; gap: 1rem; align-items: center;">
        <a href="/patient/intake" class="nav-link">New Triage</a>
      </div>
    </div>
  </header>

  <!-- ───────────────────── Main ───────────────────── -->
  <main class="container" style="max-width: 900px; padding: 2rem 1.5rem;">
    <!-- Back Navigation -->
    <div style="margin-bottom: 2rem;">
      <a href="/patient/intake"
        style="display: inline-flex; align-items: center; gap: 0.5rem; color: var(--text-secondary); text-decoration: none; font-weight: 500; font-size: 0.95rem; transition: color 0.2s;">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="19" y1="12" x2="5" y2="12"></line>
          <polyline points="12 19 5 12 12 5"></polyline>
        </svg>
        Back to Intake Form
      </a>
    </div>

    <!-- Priority Banner -->
    <div class="priority-banner"
      style="background: var(--{{ result.color }}-100, var(--danger-100)); border-left: 6px solid var(--{{ result.color }}-500, var(--danger-500)); padding: 1.5rem 2rem; border-radius: var(--radius-md); margin-bottom: 2rem; display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 1rem;">
      <div>
        <h2
          style="color: var(--{{ result.color }}-700, var(--danger-700)); margin-bottom: 0.5rem; display: flex; align-items: center; gap: 0.5rem;">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"></circle>
            <line x1="12" y1="8" x2="12" y2="12"></line>
            <line x1="12" y1="16" x2="12.01" y2="16"></line>
          </svg>
          {{ result.priority_label }}
        </h2>
        <p style="color: var(--{{ result.color }}-800, var(--danger-800)); font-weight: 500; font-size: 1.1rem;">
          Severity Score: {{ result.score }} / 10.0</p>
      </div>
      <div>
        <span class="priority-pill priority-pill-{{ result.priority | lower }}">{{ result.priority }} Priority</span>
      </div>
    </div>

    <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 2rem;">
      <!-- Main Content (Left) -->
      <div style="display: flex; flex-direction: column; gap: 1.5rem;">

        <!-- AI Summary -->
        <section class="card" style="padding: 2rem;">
          <h3
            style="color: var(--primary-900); border-bottom: 1px solid var(--surface-200); padding-bottom: 0.75rem; margin-bottom: 1rem;">
            Clinical Summary</h3>
          <p
            style="font-size: 1.1rem; line-height: 1.6; color: var(--text-primary); font-weight: 500; margin-bottom: 1rem;">
            {{ result.summary }}</p>
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-top: 1.5rem;">
            <div style="background: var(--surface-50); padding: 1rem; border-radius: var(--radius-sm);">
              <span
                style="font-size: 0.85rem; color: var(--text-tertiary); text-transform: uppercase; letter-spacing: 0.5px; font-weight: 700;">Probable
                Diagnosis</span>
              <p style="margin-top: 0.25rem; font-weight: 600; color: var(--primary-800);">{{ result.probable_diagnosis
                }}</p>
            </div>
            <div style="background: var(--primary-50); padding: 1rem; border-radius: var(--radius-sm);">
              <span
                style="font-size: 0.85rem; color: var(--primary-600); text-transform: uppercase; letter-spacing: 0.5px; font-weight: 700;">Recommended
                Dept</span>
              <p style="margin-top: 0.25rem; font-weight: 600; color: var(--primary-800);">{{
                result.recommended_department }}</p>
            </div>
          </div>
        </section>

        <!-- Detailed Assessment -->
        <section class="card" style="padding: 2rem;">
          <h3
            style="color: var(--primary-900); border-bottom: 1px solid var(--surface-200); padding-bottom: 0.75rem; margin-bottom: 1rem;">
            Medical Assessment</h3>
          <p style="line-height: 1.6; color: var(--text-secondary); margin-bottom: 1.5rem;">{{
            result.medical_description }}</p>

          <h4 style="color: var(--text-primary); margin-bottom: 0.5rem; font-size: 1rem;">Risk Factors:</h4>
          <p style="line-height: 1.5; color: var(--text-secondary); margin-bottom: 1.5rem;">{{ result.risk_factors }}
          </p>

          <h4 style="color: var(--text-primary); margin-bottom: 0.5rem; font-size: 1rem;">Why this priority level?</h4>
          <p style="line-height: 1.5; color: var(--text-secondary);">{{ result.risk_explanation }}</p>
        </section>

        <!-- Actions -->
        <section class="card" style="padding: 2rem;">
          <h3
            style="color: var(--primary-900); border-bottom: 1px solid var(--surface-200); padding-bottom: 0.75rem; margin-bottom: 1rem;">
            Immediate Actions</h3>
          <ul style="list-style-type: disc; margin-left: 1.5rem; color: var(--text-secondary); line-height: 1.7;">
            {% for action in result.immediate_actions %}
            <li>{{ action }}</li>
            {% endfor %}
          </ul>

          {% if result.medication_suggestions %}
          <div
            style="margin-top: 2rem; background: var(--warning-100); padding: 1.25rem; border-radius: var(--radius-md);">
            <h4
              style="color: var(--warning-700); margin-bottom: 0.5rem; font-size: 1rem; display: flex; align-items: center; gap: 0.5rem;">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z">
                </path>
                <line x1="12" y1="9" x2="12" y2="13"></line>
                <line x1="12" y1="17" x2="12.01" y2="17"></line>
              </svg>
              Medication Guidance
            </h4>
            <p style="font-size: 0.9rem; color: var(--warning-800); margin-bottom: 0.75rem;">{{
              result.medication_suggestions_disclaimer }}</p>
            <ul style="list-style-type: circle; margin-left: 1.5rem; color: var(--warning-800); font-size: 0.95rem;">
              {% for med in result.medication_suggestions %}
              <li>{{ med }}</li>
              {% endfor %}
            </ul>
          </div>
          {% endif %}
        </section>

      </div>

      <!-- Sidebar (Right) -->
      <div style="display: flex; flex-direction: column; gap: 1.5rem;">

        <!-- Patient Details -->
        <section class="card" style="padding: 1.5rem; background: var(--surface-0);">
          <h3
            style="color: var(--primary-900); font-size: 1.1rem; border-bottom: 1px solid var(--surface-200); padding-bottom: 0.75rem; margin-bottom: 1rem;">
            Patient Details</h3>
          <ul
            style="list-style: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 0.75rem; font-size: 0.95rem;">
            <li style="display: flex; justify-content: space-between;"><span
                style="color: var(--text-tertiary);">Name:</span> <strong style="color: var(--text-primary);">{{ name
                }}</strong></li>
            <li style="display: flex; justify-content: space-between;"><span
                style="color: var(--text-tertiary);">Age:</span> <strong style="color: var(--text-primary);">{{ age
                }}</strong></li>
            <li style="display: flex; justify-content: space-between;"><span
                style="color: var(--text-tertiary);">Contact:</span> <strong style="color: var(--text-primary);">{{
                contact }}</strong></li>
            <li
              style="display: flex; justify-content: space-between; align-items: center; margin-top: 0.5rem; padding-top: 0.5rem; border-top: 1px dashed var(--surface-200);">
              <span style="color: var(--text-tertiary);">Symptom Severity:</span> <span
                class="severity-tag severity-tag-{{ severity | lower }}">{{ severity }}</span>
            </li>
          </ul>
        </section>

        <!-- Selected Symptoms -->
        <section class="card" style="padding: 1.5rem;">
          <h3
            style="color: var(--primary-900); font-size: 1.1rem; border-bottom: 1px solid var(--surface-200); padding-bottom: 0.75rem; margin-bottom: 1rem;">
            Reported Symptoms</h3>
          <div style="display: flex; flex-wrap: wrap; gap: 0.5rem;">
            {% for s in result.selected_symptoms %}
            <span class="symptom-tag">{{ s }}</span>
            {% else %}
            <span style="color: var(--text-tertiary); font-style: italic; font-size: 0.9rem;">None selected.</span>
            {% endfor %}
          </div>

          {% if description %}
          <div style="margin-top: 1.5rem;">
            <h4
              style="color: var(--text-tertiary); font-size: 0.85rem; text-transform: uppercase; margin-bottom: 0.5rem; font-weight: 700;">
              Additional Notes</h4>
            <p
              style="font-size: 0.95rem; color: var(--text-secondary); line-height: 1.5; background: var(--surface-50); padding: 0.75rem; border-radius: var(--radius-sm); border: 1px solid var(--surface-200);">
              "{{ description }}"</p>
          </div>
          {% endif %}
        </section>

        <!-- Reassurance -->
        <div
          style="background: rgba(20, 184, 166, 0.1); border: 1px solid rgba(20, 184, 166, 0.2); border-radius: var(--radius-md); padding: 1.25rem; text-align: center;">
          <p style="color: var(--primary-800); font-size: 0.95rem; line-height: 1.5;">{{ result.reassurance }}</p>
        </div>

      </div>
    </div>
  </main>

  <footer class="site-footer" style="margin-top: 2rem;">
    <p>&copy; 2026 Smart Triage. For guidance only — not a substitute for professional medical advice.</p>
  </footer>
</body>

</html>